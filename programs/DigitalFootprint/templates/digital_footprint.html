<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Digital Footprint Finder - ZoolZ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #0a0e1a;
            color: #fff;
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* Animated neon purple crosshatch grid background */
        .grid-background {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background:
                linear-gradient(90deg, transparent 48%, rgba(168, 85, 247, 0.15) 49%, rgba(168, 85, 247, 0.15) 51%, transparent 52%),
                linear-gradient(0deg, transparent 48%, rgba(168, 85, 247, 0.15) 49%, rgba(168, 85, 247, 0.15) 51%, transparent 52%),
                linear-gradient(135deg, transparent 48%, rgba(217, 70, 239, 0.08) 49%, rgba(217, 70, 239, 0.08) 51%, transparent 52%),
                linear-gradient(45deg, transparent 48%, rgba(217, 70, 239, 0.08) 49%, rgba(217, 70, 239, 0.08) 51%, transparent 52%);
            background-size: 50px 50px, 50px 50px, 50px 50px, 50px 50px;
            background-position: 0 0, 0 0, 0 0, 0 0;
            animation: gridPulse 8s ease-in-out infinite;
            z-index: 0;
        }

        @keyframes gridPulse {
            0%, 100% { opacity: 0.6; }
            50% { opacity: 1; }
        }

        /* Header */
        .header {
            position: relative;
            z-index: 1;
            background: rgba(168, 85, 247, 0.1);
            border-bottom: 2px solid #a855f7;
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header h1 {
            font-size: 2rem;
            background: linear-gradient(135deg, #a855f7, #d946ef);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .back-btn {
            background: rgba(168, 85, 247, 0.2);
            border: 1px solid #a855f7;
            color: #fff;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
            text-decoration: none;
            display: inline-block;
        }

        .back-btn:hover {
            background: rgba(168, 85, 247, 0.4);
            box-shadow: 0 0 15px rgba(168, 85, 247, 0.5);
        }

        /* Main Container */
        .container {
            position: relative;
            z-index: 1;
            max-width: 1400px;
            margin: 0 auto;
            padding: 40px 20px;
        }

        /* Info Banner */
        .info-banner {
            background: rgba(255, 165, 0, 0.1);
            border: 1px solid rgba(255, 165, 0, 0.5);
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 30px;
        }

        .info-banner h3 {
            color: #ffaa00;
            margin-bottom: 10px;
        }

        .info-banner p {
            color: #ddd;
            line-height: 1.6;
        }

        /* Search Form */
        .search-section {
            background: rgba(168, 85, 247, 0.05);
            border: 1px solid rgba(168, 85, 247, 0.3);
            border-radius: 10px;
            padding: 30px;
            margin-bottom: 30px;
        }

        .search-section h2 {
            color: #d946ef;
            margin-bottom: 20px;
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        .form-group label {
            color: #8ab4f8;
            margin-bottom: 8px;
            font-weight: 500;
        }

        .form-group input {
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(168, 85, 247, 0.3);
            border-radius: 5px;
            padding: 12px;
            color: #fff;
            font-size: 1rem;
        }

        .form-group input:focus {
            outline: none;
            border-color: #a855f7;
            box-shadow: 0 0 10px rgba(168, 85, 247, 0.3);
        }

        .form-group input::placeholder {
            color: #666;
        }

        .search-btn {
            background: linear-gradient(135deg, #a855f7, #d946ef);
            border: none;
            color: #fff;
            padding: 15px 40px;
            border-radius: 5px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 4px 15px rgba(168, 85, 247, 0.3);
        }

        .search-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(168, 85, 247, 0.5);
        }

        .search-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* Progress Section */
        .progress-section {
            display: none;
            background: rgba(168, 85, 247, 0.05);
            border: 1px solid rgba(168, 85, 247, 0.3);
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 30px;
        }

        .progress-bar {
            width: 100%;
            height: 30px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 15px;
            overflow: hidden;
            margin-bottom: 10px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #a855f7, #d946ef);
            transition: width 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #fff;
            font-weight: 600;
        }

        .progress-message {
            color: #8ab4f8;
            font-size: 0.9rem;
        }

        /* Results Section */
        .results-section {
            display: none;
        }

        /* Risk Score Card */
        .risk-score-card {
            background: rgba(255, 0, 0, 0.1);
            border: 2px solid;
            border-radius: 10px;
            padding: 30px;
            margin-bottom: 30px;
            text-align: center;
        }

        .risk-score-card.low {
            background: rgba(0, 255, 0, 0.1);
            border-color: #00ff00;
        }

        .risk-score-card.medium {
            background: rgba(255, 165, 0, 0.1);
            border-color: #ffaa00;
        }

        .risk-score-card.high {
            background: rgba(255, 0, 0, 0.1);
            border-color: #ff0000;
        }

        .risk-score-card.critical {
            background: rgba(255, 0, 0, 0.2);
            border-color: #ff0000;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        .risk-score {
            font-size: 4rem;
            font-weight: 700;
            margin-bottom: 10px;
        }

        .risk-level {
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 10px;
        }

        .risk-recommendation {
            font-size: 1rem;
            color: #ddd;
        }

        /* Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: rgba(168, 85, 247, 0.05);
            border: 1px solid rgba(168, 85, 247, 0.3);
            border-radius: 10px;
            padding: 20px;
            text-align: center;
        }

        .stat-number {
            font-size: 2.5rem;
            font-weight: 700;
            color: #d946ef;
            margin-bottom: 10px;
        }

        .stat-label {
            color: #8ab4f8;
            font-size: 0.9rem;
        }

        /* Actions Section */
        .actions-section {
            background: rgba(168, 85, 247, 0.05);
            border: 1px solid rgba(168, 85, 247, 0.3);
            border-radius: 10px;
            padding: 30px;
            margin-bottom: 30px;
        }

        .actions-section h2 {
            color: #d946ef;
            margin-bottom: 20px;
        }

        .action-item {
            background: rgba(0, 0, 0, 0.3);
            border-left: 4px solid;
            border-radius: 5px;
            padding: 20px;
            margin-bottom: 15px;
        }

        .action-item.urgent {
            border-color: #ff0000;
        }

        .action-item.high {
            border-color: #ffaa00;
        }

        .action-item.medium {
            border-color: #ffff00;
        }

        .action-item.low {
            border-color: #00ff00;
        }

        .action-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .action-title {
            font-size: 1.1rem;
            font-weight: 600;
        }

        .urgency-badge {
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .urgency-badge.immediate {
            background: #ff0000;
        }

        .urgency-badge.high {
            background: #ffaa00;
        }

        .urgency-badge.medium {
            background: #ffff00;
            color: #000;
        }

        .urgency-badge.low {
            background: #00ff00;
            color: #000;
        }

        .action-details {
            color: #ddd;
            margin-bottom: 10px;
        }

        .action-meta {
            display: flex;
            gap: 20px;
            font-size: 0.85rem;
            color: #8ab4f8;
        }

        /* Findings Section */
        .findings-section {
            background: rgba(168, 85, 247, 0.05);
            border: 1px solid rgba(168, 85, 247, 0.3);
            border-radius: 10px;
            padding: 30px;
            margin-bottom: 30px;
        }

        .findings-section h2 {
            color: #d946ef;
            margin-bottom: 20px;
        }

        .findings-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .tab-btn {
            background: rgba(168, 85, 247, 0.1);
            border: 1px solid rgba(168, 85, 247, 0.3);
            color: #fff;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .tab-btn.active {
            background: rgba(168, 85, 247, 0.3);
            border-color: #a855f7;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .finding-item {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 5px;
            padding: 15px;
            margin-bottom: 10px;
        }

        .finding-platform {
            font-weight: 600;
            color: #d946ef;
            margin-bottom: 5px;
        }

        .finding-url {
            color: #8ab4f8;
            font-size: 0.9rem;
            word-break: break-all;
        }

        .finding-url a {
            color: #8ab4f8;
            text-decoration: none;
        }

        .finding-url a:hover {
            color: #d946ef;
        }

        .risk-badge {
            display: inline-block;
            padding: 3px 10px;
            border-radius: 10px;
            font-size: 0.75rem;
            font-weight: 600;
            margin-left: 10px;
        }

        .risk-badge.high {
            background: #ff0000;
        }

        .risk-badge.medium {
            background: #ffaa00;
        }

        .risk-badge.low {
            background: #00ff00;
            color: #000;
        }

        /* Export Button */
        .export-btn {
            background: rgba(168, 85, 247, 0.2);
            border: 1px solid #a855f7;
            color: #fff;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
            margin-right: 10px;
        }

        .export-btn:hover {
            background: rgba(168, 85, 247, 0.4);
        }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #8ab4f8;
        }

        .empty-state-icon {
            font-size: 4rem;
            margin-bottom: 20px;
        }
    </style>
</head>
<body>
    <div class="grid-background"></div>

    <!-- Header -->
    <div class="header">
        <h1>üë§ Digital Footprint Finder</h1>
        <a href="/" class="back-btn">‚Üê Back to Hub</a>
    </div>

    <!-- Main Container -->
    <div class="container">
        <!-- Info Banner -->
        <div class="info-banner">
            <h3>‚ö†Ô∏è Reputation Management Tool</h3>
            <p>
                Find all instances of your personal information across the web. This tool searches for usernames,
                email addresses, phone numbers, and more to help you identify and remove unwanted digital exposure.
                Perfect for professionals, job seekers, and anyone concerned about their online privacy.
            </p>
        </div>

        <!-- Search Section -->
        <div class="search-section">
            <h2>Search Your Digital Footprint</h2>
            <p style="color: #8ab4f8; margin-bottom: 20px;">
                Enter at least one identifier below. More information = more comprehensive results.
            </p>

            <div class="form-grid">
                <div class="form-group">
                    <label for="username">Username / Handle</label>
                    <input type="text" id="username" placeholder="e.g., john_doe123">
                </div>

                <div class="form-group">
                    <label for="email">Email Address</label>
                    <input type="email" id="email" placeholder="e.g., john@example.com">
                </div>

                <div class="form-group">
                    <label for="phone">Phone Number</label>
                    <input type="tel" id="phone" placeholder="e.g., 555-123-4567">
                </div>

                <div class="form-group">
                    <label for="full_name">Full Name</label>
                    <input type="text" id="full_name" placeholder="e.g., John Doe">
                </div>
            </div>

            <button class="search-btn" onclick="startSearch()">üîç Scan Digital Footprint</button>
        </div>

        <!-- Progress Section -->
        <div class="progress-section" id="progress-section">
            <div class="progress-bar">
                <div class="progress-fill" id="progress-fill" style="width: 0%">0%</div>
            </div>
            <div class="progress-message" id="progress-message">Starting search...</div>
        </div>

        <!-- Results Section -->
        <div class="results-section" id="results-section">
            <!-- Risk Score Card -->
            <div class="risk-score-card" id="risk-card">
                <div class="risk-score" id="risk-score">--</div>
                <div class="risk-level" id="risk-level">ANALYZING...</div>
                <div class="risk-recommendation" id="risk-recommendation">Scanning your digital footprint...</div>
            </div>

            <!-- Stats Grid -->
            <div class="stats-grid" id="stats-grid">
                <div class="stat-card">
                    <div class="stat-number" id="stat-usernames">0</div>
                    <div class="stat-label">Username Findings</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="stat-emails">0</div>
                    <div class="stat-label">Email Exposures</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="stat-breaches">0</div>
                    <div class="stat-label">Data Breaches</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="stat-phones">0</div>
                    <div class="stat-label">Phone Exposures</div>
                </div>
            </div>

            <!-- Actions Section -->
            <div class="actions-section">
                <h2>üìã Prioritized Action Plan</h2>
                <p style="color: #8ab4f8; margin-bottom: 20px;">
                    These are the recommended actions to clean up your digital footprint, sorted by urgency.
                </p>
                <div id="actions-list"></div>
            </div>

            <!-- Findings Section -->
            <div class="findings-section">
                <h2>üîç Detailed Findings</h2>

                <div class="findings-tabs">
                    <button class="tab-btn active" onclick="switchTab('usernames')">Usernames</button>
                    <button class="tab-btn" onclick="switchTab('emails')">Emails</button>
                    <button class="tab-btn" onclick="switchTab('breaches')">Breaches</button>
                    <button class="tab-btn" onclick="switchTab('phones')">Phone Numbers</button>
                    <button class="tab-btn" onclick="switchTab('names')">Name Mentions</button>
                </div>

                <div id="tab-usernames" class="tab-content active"></div>
                <div id="tab-emails" class="tab-content"></div>
                <div id="tab-breaches" class="tab-content"></div>
                <div id="tab-phones" class="tab-content"></div>
                <div id="tab-names" class="tab-content"></div>
            </div>

            <!-- Export Section -->
            <div style="text-align: center; margin-top: 30px;">
                <button class="export-btn" onclick="exportReport()">üìÑ Export Report</button>
                <button class="export-btn" onclick="exportJSON()">üíæ Export JSON</button>
            </div>
        </div>
    </div>

    <script>
        const API_BASE = '/footprint/api';
        let currentResults = null;

        async function startSearch() {
            // Get form values
            const username = document.getElementById('username').value.trim();
            const email = document.getElementById('email').value.trim();
            const phone = document.getElementById('phone').value.trim();
            const full_name = document.getElementById('full_name').value.trim();

            // Validate: at least one field required
            if (!username && !email && !phone && !full_name) {
                alert('Please enter at least one identifier to search.');
                return;
            }

            // Show progress, hide results
            document.getElementById('progress-section').style.display = 'block';
            document.getElementById('results-section').style.display = 'none';

            // Disable search button
            document.querySelector('.search-btn').disabled = true;

            try {
                // Use streaming endpoint for real-time progress
                await searchWithProgress({
                    username: username || undefined,
                    email: email || undefined,
                    phone: phone || undefined,
                    full_name: full_name || undefined
                });

            } catch (error) {
                alert('Search failed: ' + error.message);
                document.getElementById('progress-section').style.display = 'none';
            } finally {
                document.querySelector('.search-btn').disabled = false;
            }
        }

        async function searchWithProgress(formData) {
            return new Promise((resolve, reject) => {
                fetch(`${API_BASE}/search/stream`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Accept': 'text/event-stream'
                    },
                    body: JSON.stringify(formData)
                })
                .then(response => {
                    const reader = response.body.getReader();
                    const decoder = new TextDecoder();
                    let buffer = '';

                    function processStream() {
                        reader.read().then(({done, value}) => {
                            if (done) {
                                resolve();
                                return;
                            }

                            buffer += decoder.decode(value, {stream: true});
                            const lines = buffer.split('\n\n');
                            buffer = lines.pop();

                            lines.forEach(line => {
                                if (line.startsWith('data: ')) {
                                    const message = JSON.parse(line.substring(6));

                                    if (message.type === 'progress') {
                                        updateProgress(message.message, message.percent);
                                    } else if (message.type === 'result') {
                                        displayResults(message.data);
                                    } else if (message.type === 'error') {
                                        reject(new Error(message.error));
                                    }
                                }
                            });

                            processStream();
                        });
                    }

                    processStream();
                })
                .catch(reject);
            });
        }

        function updateProgress(message, percent) {
            const progressFill = document.getElementById('progress-fill');
            const progressMessage = document.getElementById('progress-message');

            progressFill.style.width = percent + '%';
            progressFill.textContent = percent + '%';
            progressMessage.textContent = message;
        }

        function displayResults(data) {
            currentResults = data;

            // Hide progress, show results
            document.getElementById('progress-section').style.display = 'none';
            document.getElementById('results-section').style.display = 'block';

            // Update risk card
            const analysis = data.exposure_analysis;
            const riskCard = document.getElementById('risk-card');
            const riskLevel = analysis.risk_level.toLowerCase();

            riskCard.className = 'risk-score-card ' + riskLevel;
            document.getElementById('risk-score').textContent = analysis.risk_score;
            document.getElementById('risk-level').textContent = analysis.risk_level;
            document.getElementById('risk-recommendation').textContent = analysis.recommendation || 'See action plan below';

            // Update stats
            const summary = data.summary;
            document.getElementById('stat-usernames').textContent = summary.total_username_findings || 0;
            document.getElementById('stat-emails').textContent = summary.total_email_findings || 0;
            document.getElementById('stat-breaches').textContent = summary.breaches_found || 0;
            document.getElementById('stat-phones').textContent = summary.total_phone_findings || 0;

            // Display actions
            displayActions(analysis.prioritized_actions);

            // Display findings
            displayFindings(data.findings);
        }

        function displayActions(actions) {
            const actionsContainer = document.getElementById('actions-list');
            actionsContainer.innerHTML = '';

            if (!actions || actions.length === 0) {
                actionsContainer.innerHTML = '<p style="color: #8ab4f8;">No immediate actions required.</p>';
                return;
            }

            actions.forEach(action => {
                const urgencyClass = action.urgency.toLowerCase().replace(' ', '-');

                const actionItem = document.createElement('div');
                actionItem.className = 'action-item ' + urgencyClass;
                actionItem.innerHTML = `
                    <div class="action-header">
                        <div class="action-title">${action.action}</div>
                        <div class="urgency-badge ${urgencyClass}">${action.urgency}</div>
                    </div>
                    <div class="action-details">${action.details}</div>
                    <div class="action-meta">
                        <span>‚è±Ô∏è ${action.estimated_time || 'Unknown'}</span>
                        <span>üìä Difficulty: ${action.difficulty || 'Unknown'}</span>
                        <span>üìÅ ${action.category}</span>
                    </div>
                `;
                actionsContainer.appendChild(actionItem);
            });
        }

        function displayFindings(findings) {
            // Usernames
            displayFindingCategory('usernames', findings.username_findings, finding => `
                <div class="finding-item">
                    <div class="finding-platform">
                        ${finding.platform}
                        <span class="risk-badge ${finding.risk_level}">${finding.risk_level.toUpperCase()}</span>
                    </div>
                    <div class="finding-url"><a href="${finding.url}" target="_blank">${finding.url}</a></div>
                </div>
            `);

            // Emails
            displayFindingCategory('emails', findings.email_findings, finding => `
                <div class="finding-item">
                    <div class="finding-platform">
                        ${finding.email} - ${finding.type}
                        <span class="risk-badge ${finding.risk_level}">${finding.risk_level.toUpperCase()}</span>
                    </div>
                    <div class="finding-url">${finding.snippet || finding.title || 'Found in search results'}</div>
                </div>
            `);

            // Breaches
            displayFindingCategory('breaches', findings.breach_findings, finding => {
                if (finding.status === 'clean') {
                    return `
                        <div class="finding-item">
                            <div class="finding-platform" style="color: #00ff00;">
                                ‚úÖ No breaches found for ${finding.email}
                            </div>
                        </div>
                    `;
                }
                return `
                    <div class="finding-item">
                        <div class="finding-platform">
                            üö® ${finding.breach_name}
                            <span class="risk-badge high">BREACH</span>
                        </div>
                        <div class="finding-url">
                            Date: ${finding.breach_date}<br>
                            Data exposed: ${finding.data_classes ? finding.data_classes.join(', ') : 'Unknown'}<br>
                            ${finding.passwords_exposed ? '‚ö†Ô∏è PASSWORDS EXPOSED!' : ''}
                        </div>
                    </div>
                `;
            });

            // Phones
            displayFindingCategory('phones', findings.phone_findings, finding => `
                <div class="finding-item">
                    <div class="finding-platform">
                        ${finding.phone}
                        <span class="risk-badge ${finding.risk_level}">${finding.risk_level.toUpperCase()}</span>
                    </div>
                    <div class="finding-url">${finding.snippet || finding.title || finding.url}</div>
                </div>
            `);

            // Names
            displayFindingCategory('names', findings.name_findings, finding => `
                <div class="finding-item">
                    <div class="finding-platform">${finding.name}</div>
                    <div class="finding-url">
                        ${finding.title || 'Unnamed source'}<br>
                        <a href="${finding.url}" target="_blank">${finding.url}</a>
                    </div>
                </div>
            `);
        }

        function displayFindingCategory(tabName, findings, renderFunc) {
            const container = document.getElementById('tab-' + tabName);
            container.innerHTML = '';

            if (!findings || findings.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon">‚úÖ</div>
                        <p>No ${tabName} found in this search.</p>
                    </div>
                `;
                return;
            }

            findings.forEach(finding => {
                container.innerHTML += renderFunc(finding);
            });
        }

        function switchTab(tabName) {
            // Remove active from all tabs
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));

            // Activate selected tab
            event.target.classList.add('active');
            document.getElementById('tab-' + tabName).classList.add('active');
        }

        async function exportReport() {
            if (!currentResults) {
                alert('No results to export. Please run a search first.');
                return;
            }

            try {
                const response = await fetch(`${API_BASE}/report`, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({
                        findings: currentResults.findings,
                        analysis: currentResults.exposure_analysis
                    })
                });

                const data = await response.json();

                // Download as text file
                const blob = new Blob([data.report], {type: 'text/plain'});
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'digital_footprint_report.txt';
                a.click();

            } catch (error) {
                alert('Export failed: ' + error.message);
            }
        }

        function exportJSON() {
            if (!currentResults) {
                alert('No results to export. Please run a search first.');
                return;
            }

            const blob = new Blob([JSON.stringify(currentResults, null, 2)], {type: 'application/json'});
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'digital_footprint_data.json';
            a.click();
        }
    </script>
</body>
</html>
